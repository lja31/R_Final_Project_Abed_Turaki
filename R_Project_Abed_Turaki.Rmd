---
title: "R_Final_Project_Abed_Turaki"
author: "Laila"
date: "2024-12-02"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)    
library(sf)
library(here)
library(mapview) ; mapviewOptions(fgb = FALSE)
library(dplyr)
library(ggplot2)
here()
dataset <- read_csv(here("population_sheet_updated.csv"))
colnames(dataset)

data_long <- dataset %>%
  pivot_longer(
    col='1984':'2023',
    names_to = "Year",
    values_to = "Value"
  )
dataset2 <- pivot_wider(data_long, names_from = 'Indicator_Name', values_from ='Value')  


```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


## Including Plots

You can also embed plots, for example:
Question 1: How did the population growth rate evolve over time in the dataset, and what factors might have contributed to these changes?

```{r }
str(dataset2)
library(ggplot2)

# Convert Year to numeric for plotting
dataset2$Year <- as.numeric(dataset2$Year)

# Create the plot
ggplot(dataset2, aes(x = Year)) +
  geom_line(aes(y = Population_male, color = "Male"), linewidth = 1) +
  geom_line(aes(y = Population_female, color = "Female"), linewidth = 1) +
  scale_color_manual(values = c("Male" = "blue", "Female" = "pink")) +
  labs(
    title = "Population of Males and Females Over the Years",
    x = "Year",
    y = "Population",
    color = "Gender"
  ) +
  theme_minimal()


```
Analysis1:Population Growth Rate Evolution

The population growth in Nigeria shows distinct trends for males and females over time. Both male and female populations have been steadily increasing from 1990 to 2020. The male population (represented by the blue line) consistently remains slightly higher than the female population (depicted by the pink line). The growth appears to be exponential, with the rate of increase accelerating over time. Key factors contributing to these changes include high fertility rates, improved healthcare leading to lower infant mortality, better life expectancy, and possibly changes in migration patterns.


Question2: What trends were observed in the mortality rate ratio over time, and how might this be indicative of broader health and socioeconomic conditions in the country?
```{r }
# Calculating maternal mortality ratio (MMR) over time in Nigeria
# Load necessary library
library(ggplot2)

# Data Preparation (assuming your dataset is called 'dataset2')
dataset2$Year <- as.numeric(dataset2$Year)

# Filter the data to remove rows with missing values in 'Maternal_mortality_ratio' and 'Year'
dataset2_clean <- dataset2 %>%
  select(Year, Maternal_mortality_ratio) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Year))

# Plotting Maternal Mortality Ratio Over Time
ggplot(dataset2_clean, aes(x = Year, y = Maternal_mortality_ratio)) +
  geom_line(color = "blue") +
  geom_point(color = "red") +  # Add points to show data points clearly
  labs(title = "Maternal Mortality Ratio Over Time in Nigeria",
       x = "Year",
       y = "Maternal Mortality Ratio") +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))  # Rotate x-axis labels for better readability

```
Analysis2: Maternal Mortality Ratio (MMR) Trends

The graph of Maternal Mortality Ratio (MMR) over time in Nigeria reveals a gradual decrease in MMR from 2000 to 2020. While the decline is slow, it is steady. However, despite the decrease, the MMR remains relatively high, above 1000 per 100,000 live births. This suggests slow improvement in maternal healthcare, with challenges in healthcare infrastructure and access still persisting. Socioeconomic development is also gradual, but there is still significant room for improvement in reducing maternal mortality in Nigeria.




Question3: How do mortality rates relate to the availability of nurses/midwives, prenatal care, and female enrollment in primary education, and what potential factors contribute to these relationships?

```{r }
# Load necessary libraries for visualization
library(ggplot2)

# 1. Correlation with Nurses and Midwives
dataset2_clean_nurses <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Nurses_and_midwives) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Nurses_and_midwives))

# Calculate and print correlation
cor_nurses <- cor(dataset2_clean_nurses$Maternal_mortality_ratio, dataset2_clean_nurses$Nurses_and_midwives)
print(paste("Correlation with Nurses and Midwives: ", cor_nurses))

# Visualize Correlation with Nurses and Midwives
ggplot(dataset2_clean_nurses, aes(x = Nurses_and_midwives, y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Nurses and Midwives",
       x = "Nurses and Midwives",
       y = "Maternal Mortality Ratio")

# 2. Correlation with Pregnant Women Receiving Prenatal Care
dataset2_clean_prenatal <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Pregnant_women_receiving_prenatal_care) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Pregnant_women_receiving_prenatal_care))

# Calculate and print correlation
cor_prenatal <- cor(dataset2_clean_prenatal$Maternal_mortality_ratio, dataset2_clean_prenatal$Pregnant_women_receiving_prenatal_care)
print(paste("Correlation with Pregnant Women Receiving Prenatal Care: ", cor_prenatal))

# Visualize Correlation with Pregnant Women Receiving Prenatal Care
ggplot(dataset2_clean_prenatal, aes(x = Pregnant_women_receiving_prenatal_care, y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Pregnant Women Receiving Prenatal Care",
       x = "Pregnant Women Receiving Prenatal Care",
       y = "Maternal Mortality Ratio")

# 3. Correlation with School Enrollment Primary Female
dataset2_clean_school <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, School_enrollment_primary_female) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(School_enrollment_primary_female))

# Calculate and print correlation
cor_school <- cor(dataset2_clean_school$Maternal_mortality_ratio, dataset2_clean_school$School_enrollment_primary_female)
print(paste("Correlation with School Enrollment Primary Female: ", cor_school))

# Visualize Correlation with School Enrollment Primary Female
ggplot(dataset2_clean_school, aes(x = School_enrollment_primary_female, y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. School Enrollment Primary Female",
       x = "School Enrollment Primary Female",
       y = "Maternal Mortality Ratio")

```
Analysis3: Mortality Rates and Related Factors

The analysis of mortality rates and their correlation with various factors shows mixed results. The correlation with the number of nurses and midwives is -0.339, which indicates a weak negative correlation. This suggests that as the number of nurses and midwives increases, the maternal mortality ratio slightly decreases. In contrast, the correlation with pregnant women receiving prenatal care is 0.087, indicating a very weak positive correlation and almost no relationship between prenatal care and maternal mortality. The correlation with female primary school enrollment is -0.391, showing a moderate negative correlation. This suggests that higher female primary school enrollment is associated with lower maternal mortality ratios. These relationships suggest that while healthcare workforce expansion may have some impact on maternal mortality, other systemic issues, such as access to quality care, play a crucial role. Education, on the other hand, appears to have a stronger influence, possibly through better health awareness and decision-making among women.



Question4: How do mortality rates and fertility relate to each other, and what potential factors contribute to this relationship?
```{r }
# 1. Regression with Fertility Rate Total
dataset2_clean_fertility <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Fertility_rate_total) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Fertility_rate_total))

# Perform Linear Regression
model_fertility <- lm(Maternal_mortality_ratio ~ Fertility_rate_total, data = dataset2_clean_fertility)

# Print Summary of the Model
summary(model_fertility)

# Plotting the regression
ggplot(dataset2_clean_fertility, aes(x = Fertility_rate_total, y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Fertility Rate Total",
       x = "Fertility Rate Total",
       y = "Maternal Mortality Ratio")

# 2. Regression with Life Expectancy at Birth
dataset2_clean_life_expectancy <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Life_expectancy_atbirth) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Life_expectancy_atbirth))

# Perform Linear Regression
model_life_expectancy <- lm(Maternal_mortality_ratio ~ Life_expectancy_atbirth, data = dataset2_clean_life_expectancy)

# Print Summary of the Model
summary(model_life_expectancy)

# Plotting the regression
ggplot(dataset2_clean_life_expectancy, aes(x = Life_expectancy_atbirth, y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Life Expectancy at Birth",
       x = "Life Expectancy at Birth",
       y = "Maternal Mortality Ratio")

# 3. Regression with Crude Death Rate
dataset2_clean_crude_death_rate <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Death_rate_crude) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Death_rate_crude))

# Perform Linear Regression
model_crude_death_rate <- lm(Maternal_mortality_ratio ~ Death_rate_crude, data = dataset2_clean_crude_death_rate)

# Print Summary of the Model
summary(model_crude_death_rate)

# Plotting the regression
ggplot(dataset2_clean_crude_death_rate, aes(x = Death_rate_crude, y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Crude Death Rate",
       x = "Crude Death Rate",
       y = "Maternal Mortality Ratio")

# 4. Regression with Infant Mortality Rate
dataset2_clean_infant_mortality <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Mortality_rate_infant) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Mortality_rate_infant))

# Perform Linear Regression
model_infant_mortality <- lm(Maternal_mortality_ratio ~ Mortality_rate_infant, data = dataset2_clean_infant_mortality)

# Print Summary of the Model
summary(model_infant_mortality)

# Plotting the regression
ggplot(dataset2_clean_infant_mortality, aes(x = Mortality_rate_infant, y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Infant Mortality Rate",
       x = "Infant Mortality Rate",
       y = "Maternal Mortality Ratio")

```
Anlaysis 4: Mortality Rates and Fertility Relationship

When examining the relationship between mortality rates and fertility, several regressions were conducted. The regression with fertility rate shows an R-squared value of 0.02076, which is very low, and a p-value of 0.5333, indicating that there is no significant linear relationship between fertility rate and maternal mortality. Similarly, the regression with life expectancy at birth yields an R-squared value of 0.0003351 and a p-value of 0.9372, suggesting no significant linear relationship between life expectancy and maternal mortality. The regression with the crude death rate also shows an extremely low R-squared value of 0.000001014 and a p-value of 0.9965, indicating no significant relationship. Lastly, the regression with infant mortality rate shows an R-squared value of 0.003133 and a p-value of 0.8096, also pointing to no significant linear relationship. These results indicate that the factors analyzed do not have a significant linear relationship with maternal mortality. The complex interplay of socioeconomic factors may influence both fertility and mortality in ways not captured by these simple linear regressions, and the possibility of non-linear relationships should be considered. Additionally, data quality or reporting issues could affect the outcomes of these analyses.



Question5: How does GDP growth over time reflect economic trends in the country, and what potential factors contribute to these trends?

```{r }
# Load required libraries for data manipulation, visualization, and time series analysis
library(ggplot2)  # For creating visualizations
library(dplyr)    # For data manipulation
library(tseries)  # For time series analysis

# Preprocess the data: clean and prepare GDP growth and Maternal Mortality Ratio
dataset2_clean_gdp_no_na <- dataset2 %>%
  # Filter out rows with NA values for GDP_growth and Maternal_mortality_ratio
  filter(!is.na(GDP_growth) & !is.na(Maternal_mortality_ratio)) %>%
  # Calculate the first difference for GDP growth and Maternal Mortality Ratio
  mutate(
    GDP_growth_diff = c(NA, diff(GDP_growth)),   # Difference in GDP growth
    MMR_diff = c(NA, diff(Maternal_mortality_ratio))  # Difference in Maternal Mortality Ratio
  ) %>%
  # Remove rows with any NA values after differencing
  na.omit()

# Summary and inspection of the differenced GDP growth data
summary(dataset2_clean_gdp_no_na$GDP_growth_diff)
head(dataset2_clean_gdp_no_na$GDP_growth_diff)

# Check for missing values in GDP_growth and Maternal Mortality Ratio before cleaning
sum(is.na(dataset2$GDP_growth))  # Count of missing GDP growth values
sum(is.na(dataset2$Maternal_mortality_ratio))  # Count of missing Maternal Mortality Ratio values

# Verify the number of rows in the cleaned dataset
nrow(dataset2_clean_gdp_no_na)
head(dataset2)  # Preview the first few rows of the original dataset

# Ensure Maternal Mortality Ratio data is complete by replacing missing values with the median
dataset2$Maternal_mortality_ratio[is.na(dataset2$Maternal_mortality_ratio)] <- 
  median(dataset2$Maternal_mortality_ratio, na.rm = TRUE)

# Check the structure of the dataset after handling missing values
str(dataset2)

# Remove rows where Maternal Mortality Ratio is NA, but keep rows where GDP growth is NA
dataset2_clean_gdp_no_na <- dataset2 %>%
  filter(!is.na(Maternal_mortality_ratio)) %>%  # Keep only rows where Maternal_mortality_ratio is not NA
  mutate(
    GDP_growth_diff = c(NA, diff(GDP_growth)),  # Differenced GDP growth
    MMR_diff = c(NA, diff(Maternal_mortality_ratio))  # Differenced Maternal Mortality Ratio
  )

# 1. Data Cleaning: Check and handle missing values
sum(is.na(dataset2_clean_gdp_no_na$GDP_growth_diff))  # Check for missing values
dataset2_clean_gdp_no_na_no_na <- dataset2_clean_gdp_no_na %>%
  filter(!is.na(GDP_growth_diff))  # Remove rows with missing GDP_growth_diff

# 2. Generate Plot
ggplot(dataset2_clean_gdp_no_na_no_na, aes(x = Year)) +
  geom_line(aes(y = GDP_growth_diff, color = "Differenced GDP Growth"), size = 1) +
  geom_line(aes(y = MMR_diff, color = "Differenced Maternal Mortality Ratio"), size = 1) +
  geom_point(aes(y = GDP_growth_diff, color = "Differenced GDP Growth"), size = 2, shape = 16) +
  geom_point(aes(y = MMR_diff, color = "Differenced Maternal Mortality Ratio"), size = 2, shape = 16) +
  labs(title = "Differenced Time Series: GDP per Capita Growth and Maternal Mortality Ratio",
       x = "Year", y = "Differenced Value") +
  scale_color_manual(name = "Legend", 
                     values = c("Differenced GDP Growth" = "blue", "Differenced Maternal Mortality Ratio" = "red")) +
  theme_minimal()

# 3. ACF plot after data cleaning
acf(dataset2_clean_gdp_no_na_no_na$GDP_growth_diff, main = "ACF of Differenced GDP per capita growth")
acf(dataset2_clean_gdp_no_na_no_na$MMR_diff, main = "ACF of Differenced Maternal Mortality Ratio")

# 4. Correlation analysis
cor(dataset2_clean_gdp_no_na_no_na$GDP_growth_diff, dataset2_clean_gdp_no_na_no_na$MMR_diff, method = "pearson")

```
Analysis 5: Economic Trends Reflected in GDP Growth

The analysis of GDP growth over time shows varied trends, reflecting the broader economic shifts in Nigeria. The differenced time series analysis indicates fluctuations in GDP growth, with occasional spikes and drops. A weak positive correlation (correlation coefficient = 0.298) exists between GDP growth and maternal mortality ratio, suggesting that economic improvements alone do not significantly impact maternal health outcomes. Factors such as uneven distribution of resources, health expenditure priorities, and persistent poverty likely overshadow the potential benefits of GDP growth. Moreover, the data suggest the need for inclusive policies that directly address healthcare infrastructure and maternal care to translate economic growth into tangible health outcomes.


Question 6: How does life expectancy at birth differ between males and females, and what factors might contribute to these disparities?
```{r }

# Check the summary statistics for male and female life expectancy
summary(dataset2$Life_expectancy_at_birth_female)
summary(dataset2$Life_expectancy_atbirth_male)
#Life Expectancy Difference:
dataset2$Life_expectancy_diff <- dataset2$Life_expectancy_at_birth_female - dataset2$Life_expectancy_atbirth_male
summary(dataset2$Life_expectancy_diff)
#
ggplot(dataset2, aes(x = Year)) +
  geom_line(aes(y = Life_expectancy_diff, color = "Life Expectancy Difference"), size = 1) +
  labs(title = "Difference in Life Expectancy at Birth: Female vs Male",
       x = "Year", y = "Life Expectancy Difference (Female - Male)") +
  scale_color_manual(name = "Legend", values = c("Life Expectancy Difference" = "purple")) +
  theme_minimal()


# Linear regression to explore factors affecting life expectancy difference
lm_model <- lm(Life_expectancy_diff ~ Maternal_mortality_ratio + Mortality_rate_adult_male + Mortality_rate_adult_female + Poverty_headcount_ratio + `Unemployment_male_%ofmalelaborforce`, data = dataset2)
summary(lm_model)



```

Analysis 6: Life Expectancy Disparities Between Genders

The analysis reveals consistent disparities in life expectancy at birth between males and females, with females generally living longer than males. The average life expectancy difference is approximately 1.83 years. Regression analysis suggests that higher maternal mortality rates and adult female mortality rates contribute to the disparity, whereas improvements in male health outcomes and poverty reduction are associated with smaller gaps. Cultural factors, healthcare access, and biological differences likely play roles in this disparity. These results emphasize the importance of targeted interventions to improve male health outcomes while continuing to address maternal and female health challenges.


Question 7:	How does the immunization rate for measles (children ages 12-23 months) correlate with under-5 mortality rates?
```{r }
# Step 1: Extract the relevant columns from the dataset
immunization_measles <- dataset2$`Immunization_measles_children_ages_12-23_m`
under_5_mortality <- dataset2$`Mortality_rate_under-5`

# Step 2: Ensure the columns are numeric
immunization_measles <- as.numeric(immunization_measles)
under_5_mortality <- as.numeric(under_5_mortality)

# Step 3: Remove rows with NA values (missing data)
dataset_clean <- na.omit(data.frame(immunization_measles, under_5_mortality))

# Step 4: Calculate the correlation between immunization rate and under-5 mortality rate
correlation <- cor(dataset_clean$immunization_measles, dataset_clean$under_5_mortality, method = "pearson")

# Print the correlation
print(paste("Correlation between immunization rate and under-5 mortality rate:", correlation))

# Step 5: Visualize the correlation with a scatter plot
library(ggplot2)
ggplot(dataset_clean, aes(x = immunization_measles, y = under_5_mortality)) +
  geom_point(color = "blue") +
  labs(title = "Correlation between Immunization Rate for Measles and Under-5 Mortality Rate",
       x = "Immunization Rate for Measles (12-23 months)",
       y = "Under-5 Mortality Rate") +
  theme_minimal()


```
Analysis 7: Immunization Rate and Under-5 Mortality

There is a moderate negative correlation (-0.519) between the immunization rate for measles (children aged 12-23 months) and under-5 mortality rates. This indicates that higher vaccination rates correspond to lower mortality among young children. This relationship underscores the critical role of immunization programs in reducing child mortality. However, the correlation also suggests that other factors, such as nutrition, sanitation, and broader healthcare access, are essential to achieving significant improvements in child survival rates. The scatter plot visualization strengthens the evidence for this inverse relationship, highlighting the importance of continued investment in vaccination efforts.

Question 8: How does the poverty headcount ratio influence the under-5 mortality rate across countries?

```{r }
# Step 1: Extract the poverty rate column
poverty_rate <- dataset2$Poverty_headcount_ratio

# Step 2: Convert to numeric if necessary
poverty_rate <- as.numeric(poverty_rate)

# Step 3: Combine the data into a clean dataset
dataset_clean <- na.omit(data.frame(
  vaccination_rate = immunization_measles,
  poverty_rate = poverty_rate,
  mortality_rate = under_5_mortality
))

# Step 4: Explore the relationship (pairwise correlations)
correlation_vaccine_mortality <- cor(dataset_clean$vaccination_rate, dataset_clean$mortality_rate, method = "pearson")
correlation_poverty_mortality <- cor(dataset_clean$poverty_rate, dataset_clean$mortality_rate, method = "pearson")
correlation_vaccine_poverty <- cor(dataset_clean$vaccination_rate, dataset_clean$poverty_rate, method = "pearson")

# Step 5: Print the correlations
cat("Correlation between Vaccination Rate and Under-5 Mortality Rate:", correlation_vaccine_mortality, "\n")
cat("Correlation between Poverty Rate and Under-5 Mortality Rate:", correlation_poverty_mortality, "\n")
cat("Correlation between Vaccination Rate and Poverty Rate:", correlation_vaccine_poverty, "\n")

# Step 6: Build a multiple linear regression model
model <- lm(mortality_rate ~ vaccination_rate + poverty_rate, data = dataset_clean)

# Step 7: Summarize the model
summary(model)

# Optional Step: Visualize the relationships
library(ggplot2)
ggplot(dataset_clean, aes(x = vaccination_rate, y = mortality_rate)) +
  geom_point() +
  geom_smooth(method = "lm", col = "blue") +
  labs(title = "Vaccination Rate vs Under-5 Mortality Rate")

ggplot(dataset_clean, aes(x = poverty_rate, y = mortality_rate)) +
  geom_point() +
  geom_smooth(method = "lm", col = "red") +
  labs(title = "Poverty Rate vs Under-5 Mortality Rate")

```
Analysis 8; Poverty Headcount Ratio and Under-5 Mortality

The analysis shows a strong positive correlation (0.782) between poverty headcount ratios and under-5 mortality rates, suggesting that higher poverty levels are associated with increased child mortality. Conversely, there is a moderate negative correlation (-0.662) between vaccination rates and under-5 mortality rates, demonstrating the mitigating impact of healthcare access. The regression model incorporating poverty and vaccination rates explains about 65% of the variability in under-5 mortality rates, with poverty showing a stronger influence. These results highlight the pressing need to address poverty and its cascading effects on health while bolstering immunization coverage to protect the most vulnerable populations.

Conclusion
The analysis of mortality trends and influencing factors in Nigeria highlights the complexities of health outcomes in a rapidly evolving socio-economic environment. While some progress has been observed, such as the decline in maternal mortality and improvements in life expectancy, critical challenges remain. High maternal mortality rates, stark gender disparities in life expectancy, and the significant impact of poverty on under-5 mortality underscore systemic gaps in healthcare access and quality, as well as broader social inequities. Our analysis shows that indicators such as education levels, immunization rates, poverty headcount ratios, and healthcare workforce availability significantly contribute to mortality rates in Nigeria, either directly or indirectly.

To drive meaningful change, Nigeria must prioritize investments in healthcare infrastructure, education, and poverty alleviation. Efforts to strengthen immunization programs, improve maternal and child healthcare, and ensure equitable distribution of resources are essential to reducing mortality rates further. Integrating economic growth with targeted health and social policies will be crucial to overcoming these challenges and fostering sustainable improvements in population health.