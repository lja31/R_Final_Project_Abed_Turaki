---
title: "R_Final_Project_Abed_Turaki"
author: "Laila and Nargis"
date: "2024-12-02"
output: pdf_document
toc: true
---
\newpage

\listoffigures

\newpage

# Introduction:

Analyzing Mortality Trends and Influencing Factors in Nigeria

This project focuses on analyzing mortality trends and the influencing factors 
in Nigeria, with a particular emphasis on maternal mortality and its correlation with various socio-economic indicators. Using data spanning several decades, we explore the relationship between public health expenditure and maternal 
mortality rates, the impact of health-related factors such as fertility rates 
and life expectancy, and how economic growth and demographic trends have 
influenced public health outcomes. By applying spatial data exploration 
techniques, time series analysis, and regression models, this project aims to provide a comprehensive understanding of the dynamics driving maternal health outcomes in Nigeria and to highlight areas for potential intervention and improvement.
Our github Repository: https://github.com/lja31/R_Final_Project_Abed_Turaki 



Table: Details about the project

|     Item | Value                               |
|---------:|-------------------------------------|
|  Country | Nigeria                             |
|     Date | 12-12-2024                          |
|   Source | World Bank                          |
|    Study | Health indicators                   |
|   Course | EDE ENVIRON 872L-1                  |
| Students | Nargis Taraki & Laila Abed          |

\newpage


# Data preparation and wrangling

```{r setup, include = TRUE, message=FALSE}

knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)    
library(sf)
library(here)
library(mapview) ; mapviewOptions(fgb = FALSE)
library(dplyr)
library(ggplot2)
here()
dataset <- read_csv(here("population_sheet_updated.csv"))
colnames(dataset)

data_long <- dataset %>%
  pivot_longer(
    col='1984':'2023',
    names_to = "Year",
    values_to = "Value"
  )
dataset2 <- pivot_wider(data_long, names_from = 'Indicator_Name', values_from ='Value')  

dataset2$Year <- as.numeric(dataset2$Year)
class(dataset2$Year)

```
\newpage


# Question 1: How did the population growth rate evolve over time in the dataset, and what factors might have contributed to these changes?

```{r, fig.cap="Population of Males and Females Over the Years" }


library(ggplot2)

# Convert Year to numeric for plotting
dataset2$Year <- as.numeric(dataset2$Year)

# Create the plot
ggplot(dataset2, aes(x = Year)) +
  geom_line(aes(y = Population_male, color = "Male"), linewidth = 1) +
  geom_line(aes(y = Population_female, color = "Female"), linewidth = 1) +
  scale_color_manual(values = c("Male" = "blue", "Female" = "pink")) +
  labs(
    title = "Population of Males and Females Over the Years",
    x = "Year",
    y = "Population",
    color = "Gender"
  ) + theme(legend.position = "bottom")

```

```{r, fig.cap="Population of Males and Females Over the Years" }
#Life expectancy 
ggplot(dataset2, aes(x = Year)) +
  geom_line(aes(y = Life_expectancy_atbirth_male, color = "Male"), 
            linewidth = 1) +
  geom_line(aes(y = Life_expectancy_at_birth_female, color = "Female"), 
            linewidth = 1) +
  scale_color_manual(values = c("Male" = "blue", "Female" = "pink")) +
  labs(
    title = "Life Expectancy Of Males and Females Over the Years",
    x = "Year",
    y = "Life Expectancy",
    color = "Gender"
  ) + theme(legend.position = "bottom")
```

```{r, fig.cap="Population of Males and Females Over the Years" }
# Survival to age 65 
ggplot(dataset2, aes(x = Year)) +
  geom_line(aes(y = Survival_to_age_65_male, color = "Male"), linewidth = 1) +
  geom_line(aes(y = Survival_to_age_65_female, color = "Female"), 
            linewidth = 1) +
  scale_color_manual(values = c("Male" = "blue", "Female" = "pink")) +
  labs(
    title = "Survival To Age 65 Males and Females Over the Years",
    x = "Year",
    y = "Survival to Age 65",
    color = "Gender"
  ) + theme(legend.position = "bottom")
```

```{r, fig.cap="Population of Males and Females Over the Years" }
# Mortality rate 
ggplot(dataset2, aes(x = Year)) +
  geom_line(aes(y = Mortality_rate_adult_male, color = "Male"), linewidth = 1) +
  geom_line(aes(y = Mortality_rate_adult_female, color = "Female"), 
            linewidth = 1) +
  scale_color_manual(values = c("Male" = "blue", "Female" = "pink")) +
  labs(
    title = "Mortality Rate Of Adult Males and Females Over the Years",
    x = "Year",
    y = "Mortality Rate",
    color = "Gender"
  ) + theme(legend.position = "bottom")
```

\newpage

## *Analysis1*:Population Growth and Demographic Trends, Life Expectancy Trends, Survival to Age 65, and Adult Mortality Rates
The population growth in Nigeria from 1990 to 2020 shows a consistent upward trend for both males and females, with the male population always slightly higher than the female population. This trend likely reflects high fertility rates and sustained population momentum. Improved healthcare, including vaccinations and maternal health initiatives, may have reduced child mortality, contributing to the accelerating growth rate. Migration patterns were not explicitly analyzed but may also play a role in shaping these demographics.

Life expectancy at birth has increased steadily for both males and females. Females consistently outlive males, with the gap between male and female life expectancy widening over time. This disparity is likely due to gender differences in health risks, access to healthcare, and biological factors. Women's improved access to maternal care and reproductive health services may also contribute to their longer life expectancy.

Survival to age 65 has shown marked improvement for both genders. Females have a consistently higher survival rate than males, reinforcing the narrative of gender disparities in health outcomes. This trend reflects overall progress in healthcare access and interventions for chronic diseases. However, male survival lags behind, suggesting the need for targeted programs addressing male-specific health risks.

Adult mortality rates have declined significantly, with males consistently exhibiting higher mortality than females. The steady reduction in these rates highlights the success of public health initiatives aimed at controlling infectious diseases, improving healthcare delivery, and addressing lifestyle-related health challenges. The slightly narrowed gap between male and female mortality rates points to overall progress in gender health equity.

In summary, population growth, rising life expectancy, improved survival rates, and declining adult mortality illustrate positive strides in Nigeria's demographic and health landscape. However, persistent gender differences in health outcomes warrant tailored public health interventions for men and women.

\newpage

# Question2: What trends were observed in the mortality rate ratio over time,and how might this be indicative of broader health and socioeconomic conditions 
in the country?
```{r, fig.cap="Maternal Mortality Ratio Over Time in Nigeria"  }
# Calculating maternal mortality ratio (MMR) over time in Nigeria
# Load necessary library
library(ggplot2)

# Data Preparation (assuming your dataset is called 'dataset2')
dataset2$Year <- as.numeric(dataset2$Year)

# Filter the data to remove rows with missing values 
dataset2_clean <- dataset2 %>%
  select(Year, Maternal_mortality_ratio) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Year))

# Plotting Maternal Mortality Ratio Over Time
ggplot(dataset2_clean, aes(x = Year, y = Maternal_mortality_ratio)) +
  geom_line(color = "blue") +
  geom_point(color = "red") +  # Add points to show data points clearly
  labs(title = "Maternal Mortality Ratio Over Time in Nigeria",
       x = "Year",
       y = "Maternal Mortality Ratio") +
  theme_minimal() +
  theme(legend.position = "bottom", 
        axis.text.x = element_text(angle = 45, hjust = 1))  

```

\newpage

## *Analysis2*: Trends in Maternal Mortality Ratio (MMR)
The Maternal Mortality Ratio (MMR) in Nigeria shows a gradual decline from 2000 to 2020 but remains alarmingly high, exceeding 1000 deaths per 100,000 live births. This slow progress suggests lingering systemic challenges, including gaps in maternal healthcare access, inadequate healthcare infrastructure, and socioeconomic barriers. Despite improvements in healthcare coverage, the persistently high MMR indicates that quality and availability of services remain insufficient in many areas.

The slight but steady downward trend points to some progress in addressing maternal health, possibly due to better antenatal care programs, increased awareness, and targeted government policies. However, the data suggests that these efforts are not yet robust enough to achieve substantial improvements in maternal outcomes. The continued high rates of maternal mortality underscore the urgent need for investments in skilled birth attendants, emergency obstetric care, and addressing socioeconomic inequalities affecting women's health.

\newpage

# Question3: How do mortality rates relate to  availability of nurses/midwives, prenatal care, and female enrollment in primary education, and what potential factors contribute to these relationships?

```{r, fig.cap="Maternal Mortality Ratio vs. Nurses and Midwives" }
# Load necessary libraries for visualization
library(ggplot2)

# 1. Correlation with Nurses and Midwives
dataset2_clean_nurses <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Nurses_and_midwives) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Nurses_and_midwives))

# Calculate and print correlation
cor_nurses <- cor(dataset2_clean_nurses$
Maternal_mortality_ratio, dataset2_clean_nurses$Nurses_and_midwives)
print(paste("Correlation with Nurses and Midwives: ", cor_nurses))

# Visualize Correlation with Nurses and Midwives
ggplot(dataset2_clean_nurses, aes(x = Nurses_and_midwives, 
                                  y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Nurses and Midwives",
       x = "Nurses and Midwives",
       y = "Maternal Mortality Ratio")
```

```{r, fig.cap="Maternal Mortality Ratio vs. Pregnant Women Receiving Prenatal Care" }
# 2. Correlation with Pregnant Women Receiving Prenatal Care
dataset2_clean_prenatal <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, 
         Pregnant_women_receiving_prenatal_care) %>%
  filter(!is.na(Maternal_mortality_ratio) & 
           !is.na(Pregnant_women_receiving_prenatal_care))

# Calculate and print correlation
cor_prenatal <- cor(dataset2_clean_prenatal
                    $Maternal_mortality_ratio, dataset2_clean_prenatal$Pregnant_women_receiving_prenatal_care)
print(paste("Correlation with Pregnant Women Receiving Prenatal Care: ", 
            cor_prenatal))

# Visualize Correlation with Pregnant Women Receiving Prenatal Care
ggplot(dataset2_clean_prenatal, aes(x = Pregnant_women_receiving_prenatal_care,
                                    y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +
  labs(title = 
         "Maternal Mortality Ratio vs. Pregnant Women Receiving Prenatal Care",
       x = "Pregnant Women Receiving Prenatal Care",
       y = "Maternal Mortality Ratio") 
```

```{r, fig.cap="Maternal Mortality Ratio vs. School Enrollment Primary Female" }
# 3. Correlation with School Enrollment Primary Female
dataset2_clean_school <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, School_enrollment_primary_female) %>%
  filter(!is.na(Maternal_mortality_ratio) & 
           !is.na(School_enrollment_primary_female))

# Calculate and print correlation
cor_school <- cor(dataset2_clean_school
                  $Maternal_mortality_ratio, 
                  dataset2_clean_school$School_enrollment_primary_female)
print(paste("Correlation with School Enrollment Primary Female: ", cor_school))

# Visualize Correlation with School Enrollment Primary Female
ggplot(dataset2_clean_school, aes(x = School_enrollment_primary_female,
                                  y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "blue", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. School Enrollment Primary Female",
       x = "School Enrollment Primary Female",
       y = "Maternal Mortality Ratio") 

```

\newpage

## *Analysis3*: Mortality Rates and Correlations with Nurses/Midwives, Prenatal Care, and Female Enrollment in Primary Education
The correlation analysis reveals mixed relationships between mortality rates and several key healthcare and education indicators:

Nurses and Midwives: A weak negative correlation (-0.339) suggests that as the number of nurses and midwives increases, maternal mortality slightly decreases. This finding highlights the importance of healthcare workforce expansion but also suggests that other systemic barriers, such as quality of care and resource distribution, may dilute the impact.
Prenatal Care: A very weak positive correlation (0.087) between maternal mortality and prenatal care indicates almost no relationship. This surprising result suggests that while prenatal care access has increased, challenges in the quality and timeliness of care may reduce its effectiveness.
Female Primary School Enrollment: A moderate negative correlation (-0.391) indicates that higher female primary school enrollment is associated with lower maternal mortality. Education likely enhances women's health awareness, decision-making abilities, and socioeconomic empowerment, contributing to better maternal health outcomes.
These relationships suggest that while expanding healthcare access and education are crucial, systemic issues like service quality and socioeconomic disparities also need to be addressed to achieve meaningful reductions in mortality rates.

\newpage

# Question4: How do mortality rates and fertility relate to each other, and what potential factors contribute to this relationship?
```{r, fig.cap="Maternal Mortality Ratio vs. Fertility Rate" }
# 1. Regression with Fertility Rate Total
dataset2_clean_fertility <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Fertility_rate_total) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Fertility_rate_total))

# Perform Linear Regression
model_fertility <- lm(Maternal_mortality_ratio ~ 
                        Fertility_rate_total, data = 
                        dataset2_clean_fertility)

# Print Summary of the Model
summary(model_fertility)

# Plotting the regression
ggplot(dataset2_clean_fertility, aes(x = Fertility_rate_total,
                                     y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Fertility Rate",
       x = "Fertility Rate Total",
       y = "Maternal Mortality Ratio") 

```

```{r, fig.cap="Relationship Between Maternal Mortality and Women's Life Expectancy" }
# -Regression Analysis: Maternal Mortality Rate vs. Women's Life Expectancy-

# Load necessary libraries
library(ggplot2)
library(dplyr)

# Filter and clean the data
dataset2_clean_life_exp <- dataset2 %>%
  select(Maternal_mortality_ratio, Life_expectancy_at_birth_female) %>%
  filter(!is.na(Maternal_mortality_ratio) &
           !is.na(Life_expectancy_at_birth_female))

# Perform regression analysis
life_exp_regression <- lm(Maternal_mortality_ratio ~ 
            Life_expectancy_at_birth_female, data = dataset2_clean_life_exp)

# Print the summary of the regression model
summary(life_exp_regression)

# Generate a scatterplot with the regression line
ggplot(dataset2_clean_life_exp, aes(x = Life_expectancy_at_birth_female,
                                    y = Maternal_mortality_ratio)) +
  geom_point(color = "blue", size = 2) +  
  geom_smooth(method = "lm", color = "red", se = TRUE) + 
  labs(
    title =
    "Relationship Between Maternal Mortality and Women's Life Expectancy",
    x = "Women's Life Expectancy at Birth (Years)",
    y = "Maternal Mortality Ratio"
  ) + theme(legend.position = "bottom")
```

```{r, fig.cap="Maternal Mortality Ratio vs. Crude Death Rate" }
# 3. Regression with Crude Death Rate
dataset2_clean_crude_death_rate <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Death_rate_crude) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Death_rate_crude))

# Perform Linear Regression
model_crude_death_rate <- lm(Maternal_mortality_ratio ~ Death_rate_crude, data
                             = dataset2_clean_crude_death_rate)

# Print Summary of the Model
summary(model_crude_death_rate)

# Plotting the regression
ggplot(dataset2_clean_crude_death_rate, aes(x = Death_rate_crude,
                                            y = Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Crude Death Rate",
       x = "Crude Death Rate",
       y = "Maternal Mortality Ratio") 

```

```{r, fig.cap="Maternal Mortality Ratio vs. Infant Mortality Rate" }
# 4. Regression with Infant Mortality Rate
dataset2_clean_infant_mortality <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Mortality_rate_infant) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Mortality_rate_infant))

# Perform Linear Regression
model_infant_mortality <- lm(Maternal_mortality_ratio ~ 
                               Mortality_rate_infant, data = 
                               dataset2_clean_infant_mortality)

# Print Summary of the Model
summary(model_infant_mortality)

# Plotting the regression
ggplot(dataset2_clean_infant_mortality, aes(x = Mortality_rate_infant, y = 
                                              Maternal_mortality_ratio)) +
  geom_point() +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  labs(title = "Maternal Mortality Ratio vs. Infant Mortality Rate",
       x = "Infant Mortality Rate",
       y = "Maternal Mortality Ratio") 
# -Combined Line Graph: Maternal Mortality Ratio vs. Infant Mortality Rate-

# Filter and clean the data
dataset2_clean_combined <- dataset2 %>%
  select(Year, Maternal_mortality_ratio, Mortality_rate_infant) %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Mortality_rate_infant))

# Generate the combined line graph
ggplot(dataset2_clean_combined, aes(x = Year)) +
  geom_line(aes(y = Maternal_mortality_ratio, color = 
                  "Maternal Mortality Ratio"), size = 1) +
  geom_line(aes(y = Mortality_rate_infant, color = 
                  "Infant Mortality Rate"), size = 1) +
  scale_color_manual(
    name = "Legend",
    values = c("Maternal Mortality Ratio" = 
                 "red", "Infant Mortality Rate" = "blue")
  ) +
  labs(
    title = "Maternal Mortality Ratio and Infant Mortality Rate Over Time",
    x = "Year",
    y = "Rate"
  ) + theme(legend.position = "bottom")


```

\newpage

## *Analysis4*: Mortality Rates and Fertility Relationships
Regression analyses of maternal mortality and fertility-related factors yield insignificant linear relationships:

Fertility Rate Total: The regression analysis shows a very low R-squared value (0.02076) and a p-value of 0.5333, indicating no significant linear relationship. High fertility rates likely contribute to maternal mortality indirectly through socioeconomic and healthcare challenges not captured in this simple model.
Life Expectancy: Similarly, life expectancy at birth shows no significant relationship with maternal mortality, with an R-squared value of 0.0003351. This could reflect the multifactorial nature of maternal mortality, influenced by systemic health inequities. We thought to add other factors/variables to the 
model like mother age, but we couldn't get this information (it was not 
available).
Crude Death Rate: An extremely low R-squared value (0.000001014) indicates no significant link, emphasizing that maternal mortality is driven by factors beyond general mortality trends.
Infant Mortality Rate: A regression with infant mortality also fails to find significant relationships (R-squared = 0.003133). However, infant and maternal health are likely interconnected through shared determinants like healthcare access and socioeconomic conditions.
These results suggest that maternal mortality trends in Nigeria are influenced by complex, non-linear factors. Future research should explore interactions between variables and incorporate broader health system and social determinants of health.

\newpage

# Question5:How does GDP growth over time reflect economic trends in country and what potential factors contribute to these trends?

```{r, fig.cap="Trend Analysis: GDP Growth and Maternal Mortality Ratio" }
# ---- Trend Analysis for GDP Growth and Maternal Mortality Ratio ----

# Load necessary libraries
library(ggplot2)
library(dplyr)

# Ensure data cleaning is done (remove missing values)
dataset2_clean <- dataset2 %>%
  filter(!is.na(GDP_growth) & !is.na(Maternal_mortality_ratio))

# Create time series objects for GDP Growth and Maternal Mortality Ratio
GDP_growth_ts <- ts(dataset2_clean$GDP_growth, start = 
                      c(min(dataset2_clean$Year)), frequency = 1)
MMR_ts <- ts(dataset2_clean$Maternal_mortality_ratio, start
             = c(min(dataset2_clean$Year)), frequency = 1)

# Apply a moving average (MA) for trend smoothing
GDP_growth_trend <- stats::filter(GDP_growth_ts, rep(1/3, 3), sides = 2)
MMR_trend <- stats::filter(MMR_ts, rep(1/3, 3), sides = 2)

# Combine smoothed trends into a data frame for plotting
trend_data <- data.frame(
  Year = dataset2_clean$Year,
  GDP_growth_trend = as.numeric(GDP_growth_trend),
  MMR_trend = as.numeric(MMR_trend)
)

# Plot the trends together
ggplot(trend_data, aes(x = Year)) +
  geom_line(aes(y = GDP_growth_trend, color = 
                  "GDP Growth Trend"), size = 1) +
  geom_line(aes(y = MMR_trend, color = 
                  "Maternal Mortality Ratio Trend"), size = 1) +
  labs(
    title = "Trend Analysis: GDP Growth and Maternal Mortality Ratio",
    x = "Year",
    y = "Smoothed Values",
    color = "Legend"
  ) +
  scale_color_manual(values = c("GDP Growth Trend" = "blue", 
                                "Maternal Mortality Ratio Trend" = "red")) + theme(legend.position = "bottom")



####### Time series
# 1. Data Cleaning: Remove rows with missing values in Maternal Mortality Ratio 
#and calculate differenced values
dataset2_clean_gdp_no_na <- dataset2 %>%
  filter(!is.na(Maternal_mortality_ratio)) %>%  # Keep only rows where Maternal Mortality Ratio is not NA
  mutate(
    GDP_growth_diff = c(NA, diff(GDP_growth)),  # Differenced GDP growth
    MMR_diff = c(NA, diff(Maternal_mortality_ratio))  # Differenced Maternal Mortality Ratio
  )

# Check and handle missing values in differenced GDP growth
sum(is.na(dataset2_clean_gdp_no_na$GDP_growth_diff))  
# Check for missing values in differenced GDP growth

# 2. Remove rows with missing differenced GDP growth values (because they are essential for the analysis)
dataset2_clean_gdp_no_na_no_na <- dataset2_clean_gdp_no_na %>%
  filter(!is.na(GDP_growth_diff))  # Remove rows with missing GDP_growth_diff

# 3. Generate the time series plot for both differenced GDP growth and Maternal Mortality Ratio
ggplot(dataset2_clean_gdp_no_na_no_na, aes(x = Year)) +
  geom_line(aes(y = GDP_growth_diff, color = "Differenced GDP Growth"), 
            size = 1) +
  geom_line(aes(y = MMR_diff, color = "Differenced Maternal Mortality Ratio"), 
            size = 1) +
  geom_point(aes(y = GDP_growth_diff, color = "Differenced GDP Growth"), 
             size = 2, shape = 16) +
  geom_point(aes(y = MMR_diff, color = "Differenced Maternal Mortality Ratio"), size = 2, shape = 16) +
  labs(title = "Differenced Time Series: GDP per Capita Growth and Maternal Mortality Ratio",
       x = "Year", y = "Differenced Value") +
  scale_color_manual(name = "Legend",
                     values = c("Differenced GDP Growth" = "blue", "Differenced Maternal Mortality Ratio" = "red")) +
  theme(legend.position = "bottom")


```

\newpage

## *Analysis 5*: Economic Trends Reflected in GDP Growth
The analysis of GDP growth trends in Nigeria from 2000 to 2020 reveals significant fluctuations, with periods of high growth followed by slower growth or contractions. These variations reflect broader economic shifts influenced by global oil prices, domestic policy changes, and macroeconomic factors. Despite periods of strong GDP growth, the correlation between GDP growth and maternal mortality is weakly positive (0.298). This suggests that economic growth alone does not directly translate to improved maternal health outcomes.

Factors such as uneven distribution of wealth, limited healthcare investment, and persistent poverty may undermine the potential benefits of economic growth. The graph of GDP growth compared to the maternal mortality trend underscores this disconnect. While GDP exhibits noticeable variability, maternal mortality remains stubbornly high with only a modest downward trend. This indicates that targeted health and social policies are necessary to channel economic gains into tangible public health improvements.

\newpage

# Question 6: How does life expectancy at birth differ between males and females and what factors might contribute to these disparities?
```{r, fig.cap="Difference in Life Expectancy at Birth: Female vs Male"}

# Check the summary statistics for male and female life expectancy
summary(dataset2$Life_expectancy_at_birth_female)
summary(dataset2$Life_expectancy_atbirth_male)

#Life Expectancy Difference:
dataset2$Life_expectancy_diff <-
  dataset2$Life_expectancy_at_birth_female - 
  dataset2$Life_expectancy_atbirth_male
summary(dataset2$Life_expectancy_diff)
#
ggplot(dataset2, aes(x = Year)) +
  geom_line(aes(y = Life_expectancy_diff, color = 
                  "Life Expectancy Difference"), size = 1) +
  labs(title = "Difference in Life Expectancy at Birth: Female vs Male",
       x = "Year", y = "Life Expectancy Difference (Female - Male)") +
  scale_color_manual(name = "Legend", values = c("Life Expectancy Difference" 
                                                 = "purple")) 

# Linear regression to explore factors affecting life expectancy difference
lm_model <- lm(Life_expectancy_diff ~ 
                 Maternal_mortality_ratio +
                 Mortality_rate_adult_male 
               + Mortality_rate_adult_female + 
                 Poverty_headcount_ratio + 
                 `Unemployment_male_%ofmalelaborforce`, 
               data = dataset2)
summary(lm_model)


```

\newpage

## *Analysis 6*:Life Expectancy Disparities Between Genders
The life expectancy analysis highlights consistent disparities between males and females. Females consistently outlive males by an average of 1.83 years, with the gap widening slightly over time. The graph of life expectancy differences indicates steady improvement in female life expectancy, likely driven by better access to maternal health services, lower risks from certain health conditions, and broader socioeconomic gains.

Regression analysis suggests that maternal mortality and adult mortality rates among females are key contributors to these disparities. Meanwhile, reductions in poverty and male-specific health risks are associated with narrowing the gender gap. Cultural norms and biological factors may also play a role, with males typically more vulnerable to risk-taking behaviors and certain diseases. These results underscore the need for targeted public health interventions to improve male health outcomes while sustaining gains for females.

\newpage

# Question 7:	How does the immunization rate for measles (children ages 12-23 months) correlate with under-5 mortality rates?
```{r, fig.cap="Immunization Rate for Measles and Under-5 Mortality Rate" }
# Step 1: Extract the relevant columns from the dataset
immunization_measles <- dataset2$`Immunization_measles_children_ages_12-23_m`
under_5_mortality <- dataset2$`Mortality_rate_under-5`

# Step 2: Ensure the columns are numeric
immunization_measles <- as.numeric(immunization_measles)
under_5_mortality <- as.numeric(under_5_mortality)

# Step 3: Remove rows with NA values (missing data)
dataset_clean <- na.omit(data.frame(immunization_measles, under_5_mortality))

# Step 4: Calculate the correlation between immunization rate 
#and under-5 mortality rate
correlation <- cor(dataset_clean$immunization_measles,
                   dataset_clean$under_5_mortality, method = "pearson")

# Print the correlation
print(paste("Correlation between immunization rate 
            and under-5 mortality rate:", correlation))

# Step 5: Visualize the correlation with a scatter plot
library(ggplot2)
ggplot(dataset_clean, aes(x = immunization_measles, y = under_5_mortality)) +
  geom_smooth(method = "lm", color = "red", se = FALSE) +
  geom_point(color = "blue") +
  labs(title = "Immunization Rate for Measles and Under-5 Mortality Rate",
       x = "Immunization Rate for Measles (12-23 months)",
       y = "Under-5 Mortality Rate") + theme(legend.position = "bottom")


```

\newpage

## *Analysis 7*:Immunization Rate and Under-5 Mortality

The relationship between immunization rates for measles (children aged 12-23 months) and under-5 mortality rates reveals a moderate negative correlation (-0.519). This indicates that higher immunization rates are associated with reduced child mortality. The scatterplot visualization reinforces this finding, showing a clear downward trend as vaccination coverage increases.

However, the correlation also highlights the influence of other factors, such as nutrition, sanitation, and access to comprehensive pediatric healthcare. While immunization programs play a critical role in reducing preventable deaths, broader systemic improvements are essential to sustain gains in child survival. These findings emphasize the need to prioritize and expand vaccination coverage while addressing complementary determinants of child health.



\newpage

# Question 8: How does the poverty headcount ratio influence  under-5 mortality rate across countries?

```{r, fig.cap="Vaccination Rate vs Under-5 Mortality Rate" }
# Step 1: Extract the poverty rate column
poverty_rate <- dataset2$Poverty_headcount_ratio

# Step 2: Convert to numeric if necessary
poverty_rate <- as.numeric(poverty_rate)

# Step 3: Combine the data into a clean dataset
dataset_clean <- na.omit(data.frame(
  vaccination_rate = immunization_measles,
  poverty_rate = poverty_rate,
  mortality_rate = under_5_mortality
))

# Step 4: Explore the relationship (pairwise correlations)
correlation_vaccine_mortality <- cor(dataset_clean$vaccination_rate, 
                            dataset_clean$mortality_rate, method = "pearson")
correlation_poverty_mortality <- cor(dataset_clean$poverty_rate, 
                            dataset_clean$mortality_rate, method = "pearson")
correlation_vaccine_poverty <- cor(dataset_clean$vaccination_rate, 
                            dataset_clean$poverty_rate, method = "pearson")

# Step 5: Print the correlations
cat("Correlation between Vaccination Rate and Under-5 Mortality Rate:", 
    correlation_vaccine_mortality, "\n")
cat("Correlation between Poverty Rate and Under-5 Mortality Rate:", 
    correlation_poverty_mortality, "\n")
cat("Correlation between Vaccination Rate and Poverty Rate:", 
    correlation_vaccine_poverty, "\n")

# Step 6: Build a multiple linear regression model
model <- lm(mortality_rate ~ vaccination_rate + poverty_rate, data = 
              dataset_clean)

# Step 7: Summarize the model
summary(model)

# Optional Step: Visualize the relationships
library(ggplot2)
ggplot(dataset_clean, aes(x = vaccination_rate, y = mortality_rate)) +
  geom_point() +
  geom_smooth(method = "lm", col = "blue") +
  labs(title = "Vaccination Rate vs Under-5 Mortality Rate")

```

```{r, fig.cap="Poverty Rate vs Under-5 Mortality Rate" }
ggplot(dataset_clean, aes(x = poverty_rate, y = mortality_rate)) +
  geom_point() +
  geom_smooth(method = "lm", col = "red") +
  labs(title = "Poverty Rate vs Under-5 Mortality Rate")

```

```{r, fig.cap="Relationship Between Poverty Rate and Maternal Mortality Rate" }
# ---- Poverty Rate vs. Maternal Mortality Rate ----

# Filter and clean the data
dataset2_clean_poverty <- dataset2 %>%
  select(Maternal_mortality_ratio, Poverty_headcount_ratio) %>% 
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Poverty_headcount_ratio)) 

# Perform regression analysis
poverty_regression <- lm(Maternal_mortality_ratio ~ Poverty_headcount_ratio, 
                         data = dataset2_clean_poverty)

# Print regression summary
summary(poverty_regression)

# Generate a scatterplot with the regression line
ggplot(dataset2_clean_poverty, aes(x = Poverty_headcount_ratio, y
                                   = Maternal_mortality_ratio)) +
  geom_point(color = "darkblue", size = 2) + 
  geom_smooth(method = "lm", color = "red", se = TRUE) +
  labs(
    title = "Relationship Between Poverty Rate and Maternal Mortality Rate",
    x = "Poverty Headcount Ratio (%)",
    y = "Maternal Mortality Ratio"
  ) 


```

\newpage

## *Analysis 8*: Poverty Headcount Ratio and Under-5 Mortality
The analysis of poverty headcount ratio and under-5 mortality reveals a strong positive correlation (0.782). This finding underscores the profound impact of poverty on child mortality, as families in impoverished conditions often lack access to adequate nutrition, healthcare, and sanitation. Conversely, vaccination rates show a moderate negative correlation (-0.662) with under-5 mortality, demonstrating the protective role of healthcare access in mitigating the effects of poverty.

A regression model incorporating both poverty and vaccination rates explains 65% of the variability in under-5 mortality rates, with poverty emerging as the stronger predictor. This highlights the cascading effects of socioeconomic disparities on child health outcomes. To reduce under-5 mortality, policies must address poverty alleviation alongside strengthening immunization programs and improving healthcare access for vulnerable populations.

\newpage

# question 9: How does public expenditure on health relate to maternal mortality rates over time, and what insights can be drawn from the trends and correlation between these two variables?

```{r, fig.cap="Relationship Between Maternal Mortality Rate and Health Expenditure" }
# ---- Load Required Libraries ----
library(ggplot2)  # For visualizations
library(dplyr)    # For data manipulation

# ---- Data Cleaning and Preprocessing ----

# Step 1: Filter the dataset to keep rows with no missing values in relevant columns
dataset2_clean_health <- dataset2 %>%
  filter(!is.na(Maternal_mortality_ratio) & !is.na(Domestic_general_government_health_expenditure_per_capita))

# Step 2: Replace any missing health expenditure values with the median as a precautionary step
dataset2$Domestic_general_government_health_expenditure_per_capita[
  is.na(dataset2$Domestic_general_government_health_expenditure_per_capita)] <- 
  median(dataset2$Domestic_general_government_health_expenditure_per_capita, 
         na.rm = TRUE)

# Step 3: Check the structure of the dataset (optional step for debugging)
# str(dataset2_clean_health)

# ---- Linear Regression Analysis ----

# Perform regression analysis: Maternal Mortality Rate vs. Health Expenditure
health_expenditure_regression <- lm(
  Maternal_mortality_ratio ~ Domestic_general_government_health_expenditure_per_capita, 
  data = dataset2_clean_health
)

# Print the summary of the regression model
summary(health_expenditure_regression)

# ---- Scatter Plot with Regression Line ----

# Create a scatter plot with a regression line
ggplot(dataset2_clean_health, aes(x = Domestic_general_government_health_expenditure_per_capita, y = Maternal_mortality_ratio)) +
  geom_point(color = "blue", size = 2) +  # Scatterplot points
  geom_smooth(method = "lm", color = "red", se = TRUE) +  # Regression line with confidence interval
  labs(
  title = "Relationship Between Maternal Mortality Rate and Health Expenditure",
    x = "Health Expenditure Per Capita (USD)",
    y = "Maternal Mortality Ratio (Per 100,000 Live Births)"
  ) + theme(legend.position = "bottom")

```

```{r, fig.cap="Trend of Health Expenditure Over Time" }
# ---- Trend Analysis for Health Expenditure ----

# Step 1: Create a time series for health expenditure
health_expenditure_ts <- ts(
dataset2_clean_health$Domestic_general_government_health_expenditure_per_capita,
  start = c(min(dataset2_clean_health$Year)),
  frequency = 1  # Annual data
)

# Step 2: Visualize the trend without decomposition
ggplot(dataset2_clean_health, aes(x = Year, y = Domestic_general_government_health_expenditure_per_capita)) +
  geom_line(color = "blue", size = 1) +  # Line plot for health expenditure
  geom_point(color = "red", size = 2) +  # Highlight individual data points
  labs(
    title = "Trend of Health Expenditure Over Time",
    x = "Year",
    y = "Health Expenditure Per Capita (USD)"
  ) + theme(legend.position = "bottom")


```

\newpage

## *Analysis 9*:Public Health Expenditure and Maternal Mortality
The relationship between public health expenditure and maternal mortality rates was analyzed using data on domestic general government health expenditure per capita. The regression analysis indicates a statistically significant negative relationship between health expenditure and maternal mortality, with a coefficient of -2.22 (p-value = 0.0109). This suggests that every 1 USD increase in per capita health expenditure is associated with a reduction of approximately 2.22 maternal deaths per 100,000 live births.

The trend analysis shows that health expenditure has gradually increased over the years, but the increments remain modest relative to the persistent high maternal mortality rates. The scatter plot illustrates this relationship, with higher expenditures corresponding to slightly lower maternal mortality ratios. Despite this, the overall impact appears limited due to the low baseline levels of health expenditure and inefficiencies in the healthcare system.

These findings emphasize the critical need to not only increase public health funding but also ensure efficient allocation and utilization of resources. Investments should focus on scaling up access to quality maternal health services, training healthcare workers, and improving emergency obstetric care to achieve meaningful reductions in maternal mortality.

\newpage

# *Conclusion*
The analysis of mortality trends and influencing factors in Nigeria provides a nuanced understanding of the socio-economic and healthcare dynamics shaping health outcomes. While some progress has been achieved, such as modest declines in maternal mortality rates and improvements in life expectancy, the persistence of high mortality levels and significant disparities highlight systemic challenges.

Although logically many factors—such as healthcare workforce availability, immunization rates, and education—should directly contribute to reduced mortality rates, the observed relationships were not always strong or statistically significant. This disconnect is likely due to the limited availability and quality of data, which may fail to fully capture the complexity and interplay of these determinants. Additionally, the presence of confounding variables, data inconsistencies, and non-linear relationships likely obscures the impact of these factors.

Despite these limitations, the analysis underscores the importance of targeted interventions. Key priorities include addressing poverty, expanding healthcare access, improving the quality of maternal and child health services, and strengthening education and immunization programs. Robust data collection and monitoring systems are essential for better understanding and addressing the multifaceted drivers of mortality, paving the way for more effective public health policies.

Our github Repository: https://github.com/lja31/R_Final_Project_Abed_Turaki 